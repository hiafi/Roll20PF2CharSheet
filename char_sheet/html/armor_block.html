<table>
    <tr class="table_header_details">
        <td></td>
        <td></td>
        <td>Total</td>
        <td>Attr</td>
        <td>Prof</td>
        <td>Item</td>
        <td>Misc</td>
        <td>Max Dex</td>
    </tr>
    <tr>
        <td class="skill_name">AC</td>
        <td>{% raw %}<button type="roll" value="&{template:skill} {{character=@{character_name}}} {{name=AC}} {{value=[[(1d20 + @{AC} - 10)]]}}" ></button>{% endraw %}</td>
        <td><input class="skinny_number" type="number" name="attr_AC" value="(10 + (((@{attr_Dexterity_mod} + @{def_AC_max_dex_bonus}) - abs(@{attr_Dexterity_mod} - @{def_AC_max_dex_bonus})) / 2) + @{def_AC_prof} + @{def_AC_item} + @{def_AC_misc})" disabled="true" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_AC_attr" value="(((@{attr_Dexterity_mod} + @{def_AC_max_dex_bonus}) - abs(@{attr_Dexterity_mod} - @{def_AC_max_dex_bonus})) / 2)"  disabled="true" /></td>
        <td>{{ ac_prof|safe }}</td>
        <td><input class="skinny_number" type="number" name="attr_def_AC_item" value="0" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_AC_misc" value="0" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_AC_max_dex_bonus" value="10" /></td>
    </tr>
    <tr>
        <td class="skill_name">Touch AC</td>
        <td>{% raw %}<button type="roll" value="&{template:skill} {{character=@{character_name}}} {{name=Touch AC}} {{value=[[(1d20 + @{tAC} - 10)]]}}" ></button>{% endraw %}</td>
        <td><input class="skinny_number" type="number" name="attr_tAC" value="(10 + (((@{attr_Dexterity_mod} + @{def_tAC_max_dex_bonus}) - abs(@{attr_Dexterity_mod} - @{def_tAC_max_dex_bonus})) / 2) + @{def_tAC_prof} + @{def_tAC_item} + @{def_tAC_misc})" disabled="true" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_AC_attr" value="(((@{attr_Dexterity_mod} + @{def_tAC_max_dex_bonus}) - abs(@{attr_Dexterity_mod} - @{def_tAC_max_dex_bonus})) / 2)"  disabled="true" /></td>
        <td>{{ tac_prof|safe }}</td>
        <td><input class="skinny_number" type="number" name="attr_def_tAC_item" value="0" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_tAC_misc" value="0" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_tAC_max_dex_bonus" value="10" /></td>
    </tr>
</table>

<table>
    <tr class="table_header_details">
        <td></td>
        <td></td>
        <td>Total</td>
        <td>Attr</td>
        <td>Prof</td>
        <td>Item</td>
        <td>Misc</td>
    </tr>
    {% for defense, attr in defenses %}
    <tr>
        <td class="skill_name">{{defense}}: </td>
        <td>{% raw %}<button type="roll" value="&{template:skill} {{character=@{character_name}}} {{name={%endraw%}{{defense}}{%raw%} Save}} {{value=[[(@{{%endraw%}{{defense}}{%raw%}})]]}}" ></button>{% endraw %}</td>
        <td><input class="skinny_number" type="number" name="attr_{{defense}}" value="(@{Level} + @{def_{{defense}}_attr} + @{def_{{defense}}_prof} + @{def_{{defense}}_item} + @{def_{{defense}}_misc})" disabled="true" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_{{defense}}_attr" value="@{attr_{{attr}}_mod}" disabled="true" /></td>
        <td>
            <select class="teml_text" name="attr_def_{{defense}}_prof">
                <option value="floor(@{level} / 2)">U</option>
                <option value="@{level}">T</option>
                <option value="@{level}+2">E</option>
                <option value="@{level}+4">M</option>
                <option value="@{level}+6">L</option>
            </select>
        </td>
        <td><input class="skinny_number" type="number" name="attr_def_{{defense}}_item" value="0" /></td>
        <td><input class="skinny_number" type="number" name="attr_def_{{defense}}_misc" value="0" /></td>
    </tr>
    {% endfor %}
</table>